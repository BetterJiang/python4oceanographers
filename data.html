<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8">
        <title>Dealing with spiky data</title>
        <link rel="stylesheet" href="http://ocefpaf.github.io/theme/css/main.css">
                <link href="http://ocefpaf.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="A Pelican Blog Atom Feed" />
                
        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://ocefpaf.github.io/">A Pelican Blog </a></h1>
                <nav><ul>
                                                                                    <li class="active"><a href="http://ocefpaf.github.io/category/data-analysis.html">Data analysis</a></li>
                                    <li ><a href="http://ocefpaf.github.io/category/misc.html">Misc</a></li>
                                    <li ><a href="http://ocefpaf.github.io/category/plotting.html">Plotting</a></li>
                                                </ul></nav>
        </header><!-- /#banner -->
        <section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="http://ocefpaf.github.io/data.html" rel="bookmark"
           title="Permalink to Dealing with spiky data">Dealing with spiky data</a></h1>
          </header>

    <div class="entry-content">
      <footer class="post-info">
        <abbr class="published" title="2013-05-20T22:58:00">
                Mon 20 May 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="http://ocefpaf.github.io/author/filipe-fernandes.html">Filipe Fernandes</a>
        </address>
        <p>In <a href="http://ocefpaf.github.io/category/data-analysis.html">Data analysis</a>. </p>
<p>tags: <a href="http://ocefpaf.github.io/tag/plotting.html">plotting</a><a href="http://ocefpaf.github.io/tag/spikes.html">spikes</a></p>
</footer><!-- /.post-info -->      <p>The first steps to clean a data-set is to remove outliers (or spikes).  Some
spikes are easy to spot with a simple histogram of the data.  Let's take a look
at a velocity time-series with some bad data.</p>
<p>{% notebook spikey_data.ipynb cells[3:4] %}</p>
<p>Can you see the bins that separate themselves from the rest?  Those are
probably spikes.  It is common practice to use a criteria of labeling the data
$3\times \sigma$ larger than the mean as outliers.  However, some spikes might
be "hidden" within the data limits, or one can remove good data together with
bad data if the data is highly variable (or episodic systems).  For a better
discussion on this topic check out Chapter 2 from Emery and Thomson -- Data
Analysis Methods in Physical Oceanography.</p>
<p>One solution is a "two(or more)-pass" criteria.  Also, one might wish to
evaluate small chunks of the data separately.  Here is an example:</p>
<p>{% notebook spikey_data.ipynb cells[1:2] %}</p>
<p>The first compute the statistics of the data ($\mu$ and $\sigma$) and marks
(but do not exclude yet) data that deviates more than $n1 \times \sigma$ from
the mean.  The second pass recompute the data statistics but now removing the
data that deviates more than $n2 \times \sigma$ from the mean.</p>
<p>The code above makes use of <a href="http://stackoverflow.com/questions/4936620/using-strides-for-an-efficient-moving-average-filter" title="NumPy stride tricks">NumPy stride tricks</a>
to avoid loops while computing $\mu$ and $\sigma$ for each <strong>block</strong>.</p>
<p>{% notebook spikey_data.ipynb cells[4:5] %}</p>
<p>The "two-pass" method did well for <em>u</em> while the $3\times \sigma$ criteria
failed not only to identify all the spikes, but also removed good data from the
time series.  On the other had, the $3\times \sigma$ criteria removed two bad
values from <em>v</em> while the two pass could one find one.  Still both methods left
behind two small spikes on <em>v</em>.</p>
<p>There are probably better ways of doing this.  Also, there are methods that are
more statistically robust and more efficient at catching bad values.  Still,
the message of this post is not actually an algorithm to remove bad data, but:</p>
<p>"To identify errors, it is necessary to examine all of the data in visual form
and to get a "feel" for the data."  -- directly from Emery and Thomson book.</p>
<p>In other words, there is no silver bullet!</p>
<p>http://www.johndcook.com/blog/2013/05/30/there-are-no-outliers/</p>
    </div><!-- /.entry-content -->
        <div class="comments">
      <h2>Comments !</h2>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_identifier = "data.html";
        var disqus_url = "http://ocefpaf.github.io/data.html";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://python4oceanographers.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>
    
  </article>
</section>
        <section id="extras" class="body">
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://ocefpaf.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-9133259-2']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'python4oceanographers';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>